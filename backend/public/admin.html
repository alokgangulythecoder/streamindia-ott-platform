<script>
// Admin Login Handler
document.addEventListener('DOMContentLoaded', function() {
    const loginForm = document.getElementById('loginForm'); // Adjust ID to match your form
    
    if (loginForm) {
        loginForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const username = document.getElementById('username').value; // Adjust ID
            const password = document.getElementById('password').value; // Adjust ID
            const loginButton = event.target.querySelector('button[type="submit"]');
            const originalButtonText = loginButton.textContent;
            
            // Disable button and show loading
            loginButton.disabled = true;
            loginButton.textContent = 'Logging in...';
            
            try {
                console.log('Attempting login...');
                
                const response = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({ 
                        username: username, 
                        password: password 
                    })
                });
                
                const data = await response.json();
                
                console.log('Login response:', data);
                
                if (data.success && data.token) {
                    // Store token and admin info
                    localStorage.setItem('adminToken', data.token);
                    localStorage.setItem('adminUser', JSON.stringify(data.admin));
                    
                    // Show success message
                    alert('Login successful! Welcome ' + data.admin.username);
                    
                    // Redirect to dashboard (adjust URL as needed)
                    window.location.href = '/admin/dashboard';
                    
                } else {
                    // Show error message
                    alert('Login failed: ' + (data.error || 'Invalid credentials'));
                    loginButton.disabled = false;
                    loginButton.textContent = originalButtonText;
                }
                
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed. Please check your connection and try again.');
                loginButton.disabled = false;
                loginButton.textContent = originalButtonText;
            }
        });
    }
});
</script>
